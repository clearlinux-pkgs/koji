From f966ae1c117255aaba6caed403bc56cb61edf7f8 Mon Sep 17 00:00:00 2001
From: William Douglas <william.douglas@intel.com>
Date: Wed, 26 Oct 2022 19:59:05 -0700
Subject: [PATCH] Stop use of function seemingly removed in python 3.11

---
 hub/kojixmlrpc.py                     | 2 +-
 tests/test_builder/test_taskparams.py | 2 +-
 www/kojiweb/wsgi_publisher.py         | 4 ++--
 3 files changed, 4 insertions(+), 4 deletions(-)

diff --git a/hub/kojixmlrpc.py b/hub/kojixmlrpc.py
index fc2cd67..5b5c673 100644
--- a/hub/kojixmlrpc.py
+++ b/hub/kojixmlrpc.py
@@ -117,7 +117,7 @@ class HandlerRegistry(object):
         ret = self.argspec_cache.get(func)
         if ret:
             return ret
-        ret = tuple(inspect.getargspec(func))
+        ret = tuple(inspect.getfullargspec(func))
         if inspect.ismethod(func) and func.__self__:
             # bound method, remove first arg
             args, varargs, varkw, defaults = ret
diff --git a/tests/test_builder/test_taskparams.py b/tests/test_builder/test_taskparams.py
index 56ee6b2..91f32d4 100644
--- a/tests/test_builder/test_taskparams.py
+++ b/tests/test_builder/test_taskparams.py
@@ -55,7 +55,7 @@ class TestParseTaskParams(unittest.TestCase):
                 spec.args.pop(0)
                 spec = spec[:-3]
             else:
-                spec = inspect.getargspec(h_class.handler)
+                spec = inspect.getfullargspec(h_class.handler)
                 # unbound method, so strip "self"
                 spec.args.pop(0)
 
diff --git a/www/kojiweb/wsgi_publisher.py b/www/kojiweb/wsgi_publisher.py
index f703f1e..ade82c2 100644
--- a/www/kojiweb/wsgi_publisher.py
+++ b/www/kojiweb/wsgi_publisher.py
@@ -216,7 +216,7 @@ class Dispatcher(object):
                 if not inspect.isfunction(val):
                     continue
                 # err on the side of paranoia
-                args = inspect.getargspec(val)
+                args = inspect.getfullargspec(val)
                 if not args[0] or args[0][0] != 'environ':
                     continue
             except Exception:
@@ -257,7 +257,7 @@ class Dispatcher(object):
             if isinstance(val, list) and len(val) == 1:
                 data[arg] = val[0]
         environ['koji.form'] = fs
-        args, varargs, varkw, defaults = inspect.getargspec(func)
+        args, varargs, varkw, defaults = inspect.getfullargspec(func)
         if not varkw:
             # remove any unexpected args
             data = dslice(data, args, strict=False)
-- 
2.37.3

