From 013491934ee067c7976b5706dc2b23ce81db0d3e Mon Sep 17 00:00:00 2001
From: George T Kramer <george.t.kramer@intel.com>
Date: Tue, 25 Feb 2020 15:34:59 -0800
Subject: [PATCH 7/7] Replace cgi.escape with html.escape

For supporting koji on python 3.8

Signed-off-by: George T Kramer <george.t.kramer@intel.com>
---
 www/kojiweb/includes/header.chtml | 4 ++--
 www/kojiweb/search.chtml          | 4 ++--
 www/lib/kojiweb/util.py           | 6 +++---
 3 files changed, 7 insertions(+), 7 deletions(-)

diff --git a/www/kojiweb/includes/header.chtml b/www/kojiweb/includes/header.chtml
index 421b3f1..cff4df4 100644
--- a/www/kojiweb/includes/header.chtml
+++ b/www/kojiweb/includes/header.chtml
@@ -1,5 +1,5 @@
 #encoding UTF-8
-#import cgi
+#import html
 #import koji
 #from kojiweb import util
 #from koji_cli.lib import greetings
@@ -51,7 +51,7 @@ $localnav
               #end if
             </select>
             #try
-                #set $old_terms = cgi.escape($terms)
+                #set $old_terms = html.escape($terms)
             #except
                 #set $old_terms = ""
             #end try
diff --git a/www/kojiweb/search.chtml b/www/kojiweb/search.chtml
index 9d83853..4864b92 100644
--- a/www/kojiweb/search.chtml
+++ b/www/kojiweb/search.chtml
@@ -1,4 +1,4 @@
-#import cgi
+#import html
 #from kojiweb import util
 #from six.moves.urllib.parse import quote
 
@@ -14,7 +14,7 @@
         #end if
         <th>Search</th>
         #try
-            #set $old_terms = cgi.escape($terms)
+            #set $old_terms = html.escape($terms)
         #except
             #set $old_terms = ""
         #end try
diff --git a/www/lib/kojiweb/util.py b/www/lib/kojiweb/util.py
index 3e8a08c..efbf856 100644
--- a/www/lib/kojiweb/util.py
+++ b/www/lib/kojiweb/util.py
@@ -21,7 +21,7 @@
 #       Mike McLean <mikem@redhat.com>
 from __future__ import absolute_import, division
 
-import cgi
+import html
 import datetime
 import hashlib
 import os
@@ -669,7 +669,7 @@ class TaskResultFragment(object):
         else:
             text = self.text[:length]
         if self.need_escape:
-            text = cgi.escape(text)
+            text = html.escape(text)
         if self.size > 0 and text == '':
             text = self.empty_str_placeholder
         return '%s%s%s' % (self.begin_tag, text, self.end_tag)
@@ -725,7 +725,7 @@ class TaskResultLine(object):
                 size += fragment.size
 
         if self.need_escape:
-            line_text = cgi.escape(line_text)
+            line_text = html.escape(line_text)
 
         return '%s%s%s%s' % (self.begin_tag, line_text, postscript, self.end_tag)
 
-- 
2.25.0

